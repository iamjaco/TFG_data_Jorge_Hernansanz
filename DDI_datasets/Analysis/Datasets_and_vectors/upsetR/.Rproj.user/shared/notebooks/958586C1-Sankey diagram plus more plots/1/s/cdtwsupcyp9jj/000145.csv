"0","pdf(""multiplot.pdf"")"
"0","layout(matrix(1:15,3,5))"
"0","position <- 0"
"0",""
"0",""
"0","for (i in line.col[1:15]) {"
"0","  "
"0","  position <- position + 1"
"0","  DDI_index_source <- DDI_index[DDI_index$Dataset_source == i,]"
"0","  # DDI_index_Subset <- DDI_index_Subset[which((DDI_index_Subset$ATC1_level_1 == ""A"" |"
"0","  #                                             DDI_index_Subset$ATC1_level_1 == ""B"" |"
"0","  #                                             DDI_index_Subset$ATC1_level_1 == ""C"") "
"0","  #                                             &                                             # This chunck commented just goes for DDIs of level A,B, or C "
"0","  #                                            (DDI_index_Subset$ATC2_level_1 == ""A"" |"
"0","  #                                             DDI_index_Subset$ATC2_level_1 == ""B"" |"
"0","  #                                             DDI_index_Subset$ATC2_level_1 == ""C"")"
"0","  #                                           )"
"0","  #                                        ,]"
"0","  "
"0","  "
"0","  # A connection data frame is a list of flows with intensity for each flow"
"0","  links <- data.frame("
"0","    source=c(DDI_index_source$ATC1_level_1), "
"0","    target=c(DDI_index_source$ATC2_level_1))"
"0","  "
"0","  adjacencyData <- with(links, table(source, target))"
"0","  "
"0","  # CIRCULAR NETWORK"
"0","  chordDiagram(adjacencyData,"
"0","         transparency = 0.15, "
"0","         grid.col = grid.col,"
"0","         scale = FALSE,"
"0","         #col = line.col[i],"
"0","         col = ""#B4B4AB"","
"0","         annotationTrack = ""grid"","
"0","         title(main = i, cex = 0.4))"
"0","  circos.trackPlotRegion(track.index = 1, panel.fun = function(x, y) {"
"0","  xlim = get.cell.meta.data(""xlim"")"
"0","  ylim = get.cell.meta.data(""ylim"")"
"0","  sector.name = get.cell.meta.data(""sector.index"")"
"0","  circos.text(mean(xlim), ylim[1] + 1.1 , sector.name, facing = ""clockwise"",cex = 0.5, niceFacing = TRUE, adj =c(0,0.5), col = ""black"")"
"0","}, bg.border = NA)"
"0","  #circos.clear()"
"0"," "
"0","}"
